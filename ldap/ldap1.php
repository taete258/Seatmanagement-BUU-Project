<?phpdefine ("AD_ENABLED", 1, true);define ("AD_SERVER", "10.4.1.82", true);define ("AD_BASEDN", "ou=People,dc=buu,dc=ac,dc=th", true);define ("AD_FILTER", "(cn=XUID)", true);function check_with_ad ($user, $key){    $retval = -1;    $vlan_no = 1;    $network_id = 0;    $ad = @ldap_connect("ldap://" . AD_SERVER);    if ($ad && $user != "" && $key != "") {        ldap_set_option($ad, LDAP_OPT_PROTOCOL_VERSION, 3);        ldap_set_option($ad, LDAP_OPT_REFERRALS, 0);        $retval = 0;        if (@ldap_bind($ad,"$user@buu.ac.th","$key")) {            $filter = preg_replace("/XUID/", "$user", AD_FILTER);            $result = ldap_search($ad, AD_BASEDN, $filter);            $entries = ldap_get_entries($ad, $result);            //$_SESSION["sess_login"]["login_id"] = get_loginid($entries[0]);            $_SESSION["sess_login"]["full_name"] = $entries[0]["displayname"][0];            $_SESSION["sess_login"]["email_addr"] = $entries[0]["mail"][0];            $_SESSION["sess_login"]["department"] = $entries[0]["company"][0];			$_SESSION["sess_login"]["employeeid"] = $entries[0]["employeeid"][0];//			print_r($entries[0]);            /*                ...             */            /* u can see all entries by...            echo "<pre>\n";            print_r($entries[0]);            echo "</pre>\n";            */            $retval = 1;        }        ldap_unbind($ad);    }    return $retval;}// ตัวอย่างครับ//print_r($_SESSION);//echo "ทดสอบ";echo check_with_ad("peerasak","password");print_r($_SESSION);?>